syntax = "proto3";

// Generated by Vyra Copy Script
// Request Access
// Request access to this module with a specific security level. This service is used by Module A to authenticate with Module B. The latest successful authentication replaces all previous sessions.
// Generated from JSON metadata - DO NOT EDIT MANUALLY

// Request message
message VBASERequestAccessRequest {
  // The name of the module requesting access (e.g., 'v2_modulemanager')
  string module_name = 1;
  // Unique identifier (UUID) of the requesting module
  int64 module_id = 2;
  // Custom role identifier for the requesting module (e.g., 'operator', 'supervisor', 'maintenance')
  string requested_role = 3;
  // Requested security level (1=NONE, 2=BASIC_AUTH, 3=EXTENDED_AUTH, 4=HMAC, 5=DIGITAL_SIGNATURE)
  uint32 requested_sl = 4;
  // Password for Level 3+ authentication (required for EXTENDED_AUTH and higher security levels)
  string password = 5;
  // Certificate Signing Request (CSR) for Level 5 authentication (base64 encoded PEM format, required only for SL5)
  string certificate_csr = 6;
}

// Response message
message VBASERequestAccessResponse {
  // Indicates if access was granted
  bool success = 1;
  // Human-readable message about the access request result
  string message = 2;
  // Session token for subsequent authenticated requests (JWT or UUID, valid until expires_at)
  string session_token = 3;
  // HMAC key for Level 4 security (hex-encoded shared secret for HMAC-SHA256, empty for SL<4)
  string hmac_key = 4;
  // Certificate for Level 5 security (PEM format signed by module CA, empty for SL<5)
  string certificate = 5;
  // Timestamp when the session token expires
  int64 expires_at = 6;
  // Granted security level (may differ from requested if downgraded)
  uint32 granted_sl = 7;
}
