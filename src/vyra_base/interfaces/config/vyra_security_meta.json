[
    {
        "tags": ["ros2_srv"],
        "type": "callable",
        "functionname": "request_access",
        "displayname": "Request Access",
        "description": "Request access to this module with a specific security level. This service is used by Module A to authenticate with Module B. The latest successful authentication replaces all previous sessions.",
        "filetype": "VBASERequestAccess.srv",
        "params": [
            {
                "displayname": "module_name",
                "datatype": "string",
                "description": "The name of the module requesting access (e.g., 'v2_modulemanager')"
            },
            {
                "datatype": "unique_identifier_msgs/UUID",
                "displayname": "module_id",
                "description": "Unique identifier (UUID) of the requesting module"
            },
            {
                "datatype": "string",
                "displayname": "requested_role",
                "description": "Custom role identifier for the requesting module (e.g., 'operator', 'supervisor', 'maintenance')"
            },
            {
                "datatype": "uint8",
                "displayname": "requested_sl",
                "description": "Requested security level (1=NONE, 2=BASIC_AUTH, 3=EXTENDED_AUTH, 4=HMAC, 5=DIGITAL_SIGNATURE)"
            },
            {
                "datatype": "string",
                "displayname": "password",
                "description": "Password for Level 3+ authentication (required for EXTENDED_AUTH and higher security levels)"
            },
            {
                "datatype": "string",
                "displayname": "certificate_csr",
                "description": "Certificate Signing Request (CSR) for Level 5 authentication (base64 encoded PEM format, required only for SL5)"
            }
        ],
        "returns": [
            {
                "name": "success",
                "datatype": "bool",
                "displayname": "Success",
                "description": "Indicates if access was granted"
            },
            {
                "name": "message",
                "datatype": "string",
                "displayname": "Message",
                "description": "Human-readable message about the access request result"
            },
            {
                "name": "session_token",
                "datatype": "string",
                "displayname": "Session Token",
                "description": "Session token for subsequent authenticated requests (JWT or UUID, valid until expires_at)"
            },
            {
                "name": "hmac_key",
                "datatype": "string",
                "displayname": "HMAC Key",
                "description": "HMAC key for Level 4 security (hex-encoded shared secret for HMAC-SHA256, empty for SL<4)"
            },
            {
                "name": "certificate",
                "datatype": "string",
                "displayname": "Certificate",
                "description": "Certificate for Level 5 security (PEM format signed by module CA, empty for SL<5)"
            },
            {
                "name": "expires_at",
                "datatype": "builtin_interfaces/Time",
                "displayname": "Expires At",
                "description": "Timestamp when the session token expires"
            },
            {
                "name": "granted_sl",
                "datatype": "uint8",
                "displayname": "Granted Security Level",
                "description": "Granted security level (may differ from requested if downgraded)"
            }
        ],
        "access_level": 1,
        "displaystyle": {
            "visible": true,
            "published": true
        }
    }
]